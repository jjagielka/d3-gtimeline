(function(S,B){typeof exports=="object"&&typeof module<"u"?B(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],B):(S=typeof globalThis<"u"?globalThis:S||self,B((S["D3 Google-like timeline chart"]=S["D3 Google-like timeline chart"]||{},S["D3 Google-like timeline chart"][""]={}),S.d3,S.dayjs))})(this,function(S,B,G){"use strict";function U(n){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const c in n)if(c!=="default"){const d=Object.getOwnPropertyDescriptor(n,c);Object.defineProperty(r,c,d.get?d:{enumerable:!0,get:()=>n[c]})}}return r.default=n,Object.freeze(r)}const y=U(B),tt="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function L(n){y.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(tt);const r=y.select("body").append("div").attr("class","tooltip").style("opacity",0);return r.show=function(c){r.transition().duration(100).style("opacity",.95),r.html(n.apply(null,arguments)).style("left",c.pageX+"px").style("top",c.pageY-28+"px")},r.hide=function(c){r.transition().duration(100).style("opacity",0)},r}function et(n){return y.max(n.nodes().map(r=>r.getComputedTextLength()))}function nt(n){return function(r){return r.length>n?r.slice(0,n-1)+"…":r}}const z=1,rt=2;function q(n,r){let c=["#FFF","#EEE"],d=5,w,k="#AAA",_=40,b=100,l;function s(o){let T=r.domain(),A=L(m=>m),h=y.scaleOrdinal(c),Y=y.scaleOrdinal(c.reverse()),a=nt(_),f=o.selectAll(".row").data(T,r).order(),p=f.enter().append("g").attr("class","row"),j=f.exit(),$=f.select("text");f=f.merge(p).attr("transform",m=>"translate(0,"+r(m)+")"),j.remove(),p.append("rect").attr("y",.5).attr("width",b).attr("height",r.bandwidth()).attr("stroke",k).attr("stroke-width",.75).attr("fill",h),p.append("path").attr("stroke",Y),$=$.merge(p.append("text").attr("y",r.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(m,i){y.select(this).text()!=i&&A.show(i)}).on("mouseout",A.hide)).text(a),l===void 0&&(l=et($)+2*d,l=n===z?b-l:l),w=n===z?[0,l]:[l,b],$.attr("text-anchor",n===z?"start":"end").attr("dx",n===z?d:-d).attr("x",l);const D=function(m,i){l=Math.max(10,Math.min(b-10,l+m.dx)),y.select(this).attr("d","M"+l+",0.5V"+r.range()[1]),$.attr("x",l),w=n===z?[0,l]:[l,b],o.dispatch("offset",{detail:{offset:l}})};o.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",k).attr("stroke-width",1.75).attr("d","M"+(l+.5)+",0.5V"+r.range()[1]).style("cursor","ew-resize").call(y.drag().on("drag",D))}return s.draw_ticks=function(o,T){o.selectAll(".row").select("path").attr("d",T.map(A=>"M"+A+",1v"+(r.bandwidth()-1)).join(""))},s.scale=function(o){return arguments.length?(r=o,s):r},s.width=function(o){return arguments.length?(b=o,s):b},s.colors=function(o){return arguments.length?(c=o,s):c},s.padding=function(o){return arguments.length?(d=o,s):d},s.range=function(o){return arguments.length?(w=o,s):w},s.trim=function(o){return arguments.length?(_=o,s):_},s.offset=function(o){return arguments.length?(l=o,s):l},s}function I(n){return q(rt,n)}function W(n){return q(z,n)}var J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function X(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Z={exports:{}};(function(n,r){(function(c,d){n.exports=d()})(J,function(){var c,d,w=1e3,k=6e4,_=36e5,b=864e5,l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,s=31536e6,o=2628e6,T=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,A={years:s,months:o,days:b,hours:_,minutes:k,seconds:w,milliseconds:1,weeks:6048e5},h=function(i){return i instanceof D},Y=function(i,e,t){return new D(i,t,e.$l)},a=function(i){return d.p(i)+"s"},f=function(i){return i<0},p=function(i){return f(i)?Math.ceil(i):Math.floor(i)},j=function(i){return Math.abs(i)},$=function(i,e){return i?f(i)?{negative:!0,format:""+j(i)+e}:{negative:!1,format:""+i+e}:{negative:!1,format:""}},D=function(){function i(t,u,v){var g=this;if(this.$d={},this.$l=v,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),u)return Y(t*A[a(u)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(O){g.$d[a(O)]=t[O]}),this.calMilliseconds(),this;if(typeof t=="string"){var M=t.match(T);if(M){var x=M.slice(2).map(function(O){return O!=null?Number(O):0});return this.$d.years=x[0],this.$d.months=x[1],this.$d.weeks=x[2],this.$d.days=x[3],this.$d.hours=x[4],this.$d.minutes=x[5],this.$d.seconds=x[6],this.calMilliseconds(),this}}return this}var e=i.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(u,v){return u+(t.$d[v]||0)*A[v]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=p(t/s),t%=s,this.$d.months=p(t/o),t%=o,this.$d.days=p(t/b),t%=b,this.$d.hours=p(t/_),t%=_,this.$d.minutes=p(t/k),t%=k,this.$d.seconds=p(t/w),t%=w,this.$d.milliseconds=t},e.toISOString=function(){var t=$(this.$d.years,"Y"),u=$(this.$d.months,"M"),v=+this.$d.days||0;this.$d.weeks&&(v+=7*this.$d.weeks);var g=$(v,"D"),M=$(this.$d.hours,"H"),x=$(this.$d.minutes,"M"),O=this.$d.seconds||0;this.$d.milliseconds&&(O+=this.$d.milliseconds/1e3,O=Math.round(1e3*O)/1e3);var E=$(O,"S"),R=t.negative||u.negative||g.negative||M.negative||x.negative||E.negative,P=M.format||x.format||E.format?"T":"",H=(R?"-":"")+"P"+t.format+u.format+g.format+P+M.format+x.format+E.format;return H==="P"||H==="-P"?"P0D":H},e.toJSON=function(){return this.toISOString()},e.format=function(t){var u=t||"YYYY-MM-DDTHH:mm:ss",v={Y:this.$d.years,YY:d.s(this.$d.years,2,"0"),YYYY:d.s(this.$d.years,4,"0"),M:this.$d.months,MM:d.s(this.$d.months,2,"0"),D:this.$d.days,DD:d.s(this.$d.days,2,"0"),H:this.$d.hours,HH:d.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:d.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:d.s(this.$d.seconds,2,"0"),SSS:d.s(this.$d.milliseconds,3,"0")};return u.replace(l,function(g,M){return M||String(v[g])})},e.as=function(t){return this.$ms/A[a(t)]},e.get=function(t){var u=this.$ms,v=a(t);return v==="milliseconds"?u%=1e3:u=v==="weeks"?p(u/A[v]):this.$d[v],u||0},e.add=function(t,u,v){var g;return g=u?t*A[a(u)]:h(t)?t.$ms:Y(t,this).$ms,Y(this.$ms+g*(v?-1:1),this)},e.subtract=function(t,u){return this.add(t,u,!0)},e.locale=function(t){var u=this.clone();return u.$l=t,u},e.clone=function(){return Y(this.$ms,this)},e.humanize=function(t){return c().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.valueOf=function(){return this.asMilliseconds()},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},i}(),m=function(i,e,t){return i.add(e.years()*t,"y").add(e.months()*t,"M").add(e.days()*t,"d").add(e.hours()*t,"h").add(e.minutes()*t,"m").add(e.seconds()*t,"s").add(e.milliseconds()*t,"ms")};return function(i,e,t){c=t,d=t().$utils(),t.duration=function(g,M){var x=t.locale();return Y(g,{$l:x},M)},t.isDuration=h;var u=e.prototype.add,v=e.prototype.subtract;e.prototype.add=function(g,M){return h(g)?m(this,g,1):u.bind(this)(g,M)},e.prototype.subtract=function(g,M){return h(g)?m(this,g,-1):v.bind(this)(g,M)}}})})(Z);var it=Z.exports;const st=X(it);var K={exports:{}};(function(n,r){(function(c,d){n.exports=d()})(J,function(){return function(c,d,w){c=c||{};var k=d.prototype,_={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function b(s,o,T,A){return k.fromToBase(s,o,T,A)}w.en.relativeTime=_,k.fromToBase=function(s,o,T,A,h){for(var Y,a,f,p=T.$locale().relativeTime||_,j=c.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],$=j.length,D=0;D<$;D+=1){var m=j[D];m.d&&(Y=A?w(s).diff(T,m.d,!0):T.diff(s,m.d,!0));var i=(c.rounding||Math.round)(Math.abs(Y));if(f=Y>0,i<=m.r||!m.r){i<=1&&D>0&&(m=j[D-1]);var e=p[m.l];h&&(i=h(""+i)),a=typeof e=="string"?e.replace("%d",i):e(i,o,m.l,f);break}}if(o)return a;var t=f?p.future:p.past;return typeof t=="function"?t(a):t.replace("%s",a)},k.to=function(s,o){return b(s,o,this,!0)},k.from=function(s,o){return b(s,o,this)};var l=function(s){return s.$u?w.utc():w()};k.toNow=function(s){return this.to(l(this),s)},k.fromNow=function(s){return this.from(l(this),s)}}})})(K);var ot=K.exports;const at=X(ot);G.extend(st),G.extend(at);function Q(n,r){return G.duration(r-n).humanize()}function V(){const n=Array.prototype.slice.call(arguments,0);return function(r){return n.reduce((c,d)=>d(c),r)}}function N(n){return function(r){return n===void 0?r:r[n]}}const ut=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function dt(n){const r=window.getComputedStyle(n,null).getPropertyValue("font-size");return parseFloat(r)}function ct(n){return n.r*.299+n.g*.587+n.b*.114}function lt(n){return ct(n)>165}function ht(n){return lt(y.color(n))?"black":"white"}function C(n,r){return"translate("+n+","+r+")"}function ft(){let n=ut,r=5,c=!1,d=!1,w,k,_=0,b=N(0),l=N(1),s=N(2),o=N(3);function T(a){a.each(function(f,p){const j=y.select(this.parentNode),$=j.select("text"),D=j.select("rect"),m=D.attr("width")-2*r,i=l(f);$.text(i);let e=$.node().getComputedTextLength();if(e>m){const t=m<0?0:m/e,u=Math.floor(i.length*t);$.text(u>2?i.slice(0,u-2)+"…":"")}})}function A(a,f){y.active(this).tween("text",function(){return function(p){T(y.select(this))}})}function h(a){const f=a.datum(),p=new Set(y.map(f,b)),j=new L(Y),$=y.scaleOrdinal(n);w=w||[y.min(f,s),y.max(f,o)],d&&(w=y.extent(w.concat(new Date))),a.each(function(D){const m=k||this.getBoundingClientRect().width,i=p.size*(dt(this)+4*r),e=y.scaleBand().domain(p).range([0,i]),t=y.scaleTime().domain(w),u=(c?W:I)(e).width(m),v=y.select(this).selectAll("svg").data([1]).join("svg");v.attr("class","timeline").attr("width",m).attr("height",i+20);const g=v.append("g"),M=g.append("g").attr("class","y axis").call(u);let x=u.range();t.range([x[0]+r,x[1]-r]).clamp(!0);const O=y.axisBottom(t),E=g.append("g").attr("class","x axis").attr("transform",C(0,i)).call(O);M.on("offset",()=>{x=u.range(),t.range([x[0]+r,x[1]-r]).clamp(!0),O.ticks(Math.min((x[1]-x[0])/70,10)),E.call(O),P.attr("transform",F=>C(t(s(F)),e(b(F)))).selectAll("rect").attr("width",F=>t(o(F))-t(s(F))).call(T),M.call(u.draw_ticks,t.ticks().map(t))}),E.select(".domain").remove(),E.selectAll(".tick line").attr("stroke","#AAA");const R=t.ticks().map(t);M.call(u.draw_ticks,R);let P=g.selectAll("g.task").data(D);P.exit().remove();const H=P.enter().append("g").classed("task",!0);H.append("rect").attr("y",r).attr("height",e.bandwidth()-2*r).on("mouseover",j.show).on("mouseout",j.hide).style("fill",V(l,$)),H.append("text").attr("text-anchor","start").attr("fill",V(l,$,ht)).attr("pointer-events","none").attr("dx",r).attr("y",e.bandwidth()/2).attr("dy","0.32em").text(l),P=P.merge(H),P.attr("transform",F=>C(x[0],e(b(F)))).selectAll("rect").attr("width",0),P.transition().duration(_).attr("transform",F=>C(t(s(F)),e(b(F)))).selectAll("rect").attr("width",F=>t(o(F))-t(s(F))).on("start",A),d&&g.append("path").attr("stroke","red").attr("d","M"+t(new Date)+",0.5V"+i)})}return h.dates=function(a){return arguments.length?(w=a,h):w},h.width=function(a){return arguments.length?(k=a,h):k},h.today=function(a){return arguments.length?(d=a,h):d},h.colors=function(a){return arguments.length?(n=a,h):n},h.padding=function(a){return arguments.length?(r=a,h):r},h.reversed=function(a){return arguments.length?(c=a,h):c},h.duration=function(a){return arguments.length?(_=a,h):_},h;function Y(a,f){const p=V(y.isoParse,y.timeFormat("%Y-%m-%d"));return"<b>"+l(f)+'</b><hr style="margin: 2px 0 2px 0">'+p(s(f))+" - "+p(o(f))+"<br>"+Q(s(f),o(f))}}S.durationFormat=Q,S.timeline=ft,S.timelineAxisLeft=I,S.timelineAxisRight=W,S.tooltip=L,Object.defineProperty(S,Symbol.toStringTag,{value:"Module"})});
