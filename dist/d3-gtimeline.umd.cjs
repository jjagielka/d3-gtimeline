(function(S,E){typeof exports=="object"&&typeof module<"u"?E(exports,require("d3"),require("dayjs")):typeof define=="function"&&define.amd?define(["exports","d3","dayjs"],E):(S=typeof globalThis<"u"?globalThis:S||self,E(S.d3=S.d3||{},S.d3,S.dayjs))})(this,function(S,E,L){"use strict";function U(n){const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const c in n)if(c!=="default"){const d=Object.getOwnPropertyDescriptor(n,c);Object.defineProperty(r,c,d.get?d:{enumerable:!0,get:()=>n[c]})}}return r.default=n,Object.freeze(r)}const y=U(E),tt="div.tooltip {        position: absolute;        text-align: center;        padding: 5px;        /* font: 12px sans-serif; */        background: white;        border: 1px solid #AAA;        border-radius: 2px;        pointer-events: none;      }";function V(n){y.select("head").selectAll("#tooltip").data([1]).enter().append("style").attr("id","tooltip").text(tt);const r=y.select("body").append("div").attr("class","tooltip").style("opacity",0);return r.show=function(c){r.transition().duration(100).style("opacity",.95),r.html(n.apply(null,arguments)).style("left",c.pageX+"px").style("top",c.pageY-28+"px")},r.hide=function(c){r.transition().duration(100).style("opacity",0)},r}function et(n){return y.max(n.nodes().map(r=>r.getComputedTextLength()))}function nt(n){return function(r){return r.length>n?r.slice(0,n-1)+"…":r}}const B=1,rt=2;function q(n,r){let c=["#FFF","#EEE"],d=5,$,k="#AAA",_=40,b=100,l;function i(o){let O=r.domain(),A=V(m=>m),h=y.scaleOrdinal(c),Y=y.scaleOrdinal(c.reverse()),a=nt(_),f=o.selectAll(".row").data(O,r).order(),p=f.enter().append("g").attr("class","row"),D=f.exit(),x=f.select("text");f=f.merge(p).attr("transform",m=>"translate(0,"+r(m)+")"),D.remove(),p.append("rect").attr("y",.5).attr("width",b).attr("height",r.bandwidth()).attr("stroke",k).attr("stroke-width",.75).attr("fill",h),p.append("path").attr("stroke",Y),x=x.merge(p.append("text").attr("y",r.bandwidth()/2).attr("dy","0.32em").on("mouseover",function(m,s){y.select(this).text()!=s&&A.show(s)}).on("mouseout",A.hide)).text(a),l===void 0&&(l=et(x)+2*d,l=n===B?b-l:l),$=n===B?[0,l]:[l,b],x.attr("text-anchor",n===B?"start":"end").attr("dx",n===B?d:-d).attr("x",l);const T=function(m,s){l=Math.max(10,Math.min(b-10,l+m.dx)),y.select(this).attr("d","M"+l+",0.5V"+r.range()[1]),x.attr("x",l),$=n===B?[0,l]:[l,b],o.dispatch("offset",{detail:{offset:l}})};o.selectAll("g.y.axis > path").data([1]).join("path").attr("stroke",k).attr("stroke-width",1.75).attr("d","M"+(l+.5)+",0.5V"+r.range()[1]).style("cursor","ew-resize").call(y.drag().on("drag",T))}return i.draw_ticks=function(o,O){o.selectAll(".row").select("path").attr("d",O.map(A=>"M"+A+",1v"+(r.bandwidth()-1)).join(""))},i.scale=function(o){return arguments.length?(r=o,i):r},i.width=function(o){return arguments.length?(b=o,i):b},i.colors=function(o){return arguments.length?(c=o,i):c},i.padding=function(o){return arguments.length?(d=o,i):d},i.range=function(o){return arguments.length?($=o,i):$},i.trim=function(o){return arguments.length?(_=o,i):_},i.offset=function(o){return arguments.length?(l=o,i):l},i}function I(n){return q(rt,n)}function W(n){return q(B,n)}var J=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function X(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Z={exports:{}};(function(n,r){(function(c,d){n.exports=d()})(J,function(){var c,d,$=1e3,k=6e4,_=36e5,b=864e5,l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,i=31536e6,o=2628e6,O=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,A={years:i,months:o,days:b,hours:_,minutes:k,seconds:$,milliseconds:1,weeks:6048e5},h=function(s){return s instanceof T},Y=function(s,e,t){return new T(s,t,e.$l)},a=function(s){return d.p(s)+"s"},f=function(s){return s<0},p=function(s){return f(s)?Math.ceil(s):Math.floor(s)},D=function(s){return Math.abs(s)},x=function(s,e){return s?f(s)?{negative:!0,format:""+D(s)+e}:{negative:!1,format:""+s+e}:{negative:!1,format:""}},T=function(){function s(t,u,v){var g=this;if(this.$d={},this.$l=v,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),u)return Y(t*A[a(u)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(j){g.$d[a(j)]=t[j]}),this.calMilliseconds(),this;if(typeof t=="string"){var M=t.match(O);if(M){var w=M.slice(2).map(function(j){return j!=null?Number(j):0});return this.$d.years=w[0],this.$d.months=w[1],this.$d.weeks=w[2],this.$d.days=w[3],this.$d.hours=w[4],this.$d.minutes=w[5],this.$d.seconds=w[6],this.calMilliseconds(),this}}return this}var e=s.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(u,v){return u+(t.$d[v]||0)*A[v]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=p(t/i),t%=i,this.$d.months=p(t/o),t%=o,this.$d.days=p(t/b),t%=b,this.$d.hours=p(t/_),t%=_,this.$d.minutes=p(t/k),t%=k,this.$d.seconds=p(t/$),t%=$,this.$d.milliseconds=t},e.toISOString=function(){var t=x(this.$d.years,"Y"),u=x(this.$d.months,"M"),v=+this.$d.days||0;this.$d.weeks&&(v+=7*this.$d.weeks);var g=x(v,"D"),M=x(this.$d.hours,"H"),w=x(this.$d.minutes,"M"),j=this.$d.seconds||0;this.$d.milliseconds&&(j+=this.$d.milliseconds/1e3,j=Math.round(1e3*j)/1e3);var H=x(j,"S"),R=t.negative||u.negative||g.negative||M.negative||w.negative||H.negative,F=M.format||w.format||H.format?"T":"",z=(R?"-":"")+"P"+t.format+u.format+g.format+F+M.format+w.format+H.format;return z==="P"||z==="-P"?"P0D":z},e.toJSON=function(){return this.toISOString()},e.format=function(t){var u=t||"YYYY-MM-DDTHH:mm:ss",v={Y:this.$d.years,YY:d.s(this.$d.years,2,"0"),YYYY:d.s(this.$d.years,4,"0"),M:this.$d.months,MM:d.s(this.$d.months,2,"0"),D:this.$d.days,DD:d.s(this.$d.days,2,"0"),H:this.$d.hours,HH:d.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:d.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:d.s(this.$d.seconds,2,"0"),SSS:d.s(this.$d.milliseconds,3,"0")};return u.replace(l,function(g,M){return M||String(v[g])})},e.as=function(t){return this.$ms/A[a(t)]},e.get=function(t){var u=this.$ms,v=a(t);return v==="milliseconds"?u%=1e3:u=v==="weeks"?p(u/A[v]):this.$d[v],u||0},e.add=function(t,u,v){var g;return g=u?t*A[a(u)]:h(t)?t.$ms:Y(t,this).$ms,Y(this.$ms+g*(v?-1:1),this)},e.subtract=function(t,u){return this.add(t,u,!0)},e.locale=function(t){var u=this.clone();return u.$l=t,u},e.clone=function(){return Y(this.$ms,this)},e.humanize=function(t){return c().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.valueOf=function(){return this.asMilliseconds()},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},s}(),m=function(s,e,t){return s.add(e.years()*t,"y").add(e.months()*t,"M").add(e.days()*t,"d").add(e.hours()*t,"h").add(e.minutes()*t,"m").add(e.seconds()*t,"s").add(e.milliseconds()*t,"ms")};return function(s,e,t){c=t,d=t().$utils(),t.duration=function(g,M){var w=t.locale();return Y(g,{$l:w},M)},t.isDuration=h;var u=e.prototype.add,v=e.prototype.subtract;e.prototype.add=function(g,M){return h(g)?m(this,g,1):u.bind(this)(g,M)},e.prototype.subtract=function(g,M){return h(g)?m(this,g,-1):v.bind(this)(g,M)}}})})(Z);var st=Z.exports;const it=X(st);var K={exports:{}};(function(n,r){(function(c,d){n.exports=d()})(J,function(){return function(c,d,$){c=c||{};var k=d.prototype,_={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function b(i,o,O,A){return k.fromToBase(i,o,O,A)}$.en.relativeTime=_,k.fromToBase=function(i,o,O,A,h){for(var Y,a,f,p=O.$locale().relativeTime||_,D=c.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],x=D.length,T=0;T<x;T+=1){var m=D[T];m.d&&(Y=A?$(i).diff(O,m.d,!0):O.diff(i,m.d,!0));var s=(c.rounding||Math.round)(Math.abs(Y));if(f=Y>0,s<=m.r||!m.r){s<=1&&T>0&&(m=D[T-1]);var e=p[m.l];h&&(s=h(""+s)),a=typeof e=="string"?e.replace("%d",s):e(s,o,m.l,f);break}}if(o)return a;var t=f?p.future:p.past;return typeof t=="function"?t(a):t.replace("%s",a)},k.to=function(i,o){return b(i,o,this,!0)},k.from=function(i,o){return b(i,o,this)};var l=function(i){return i.$u?$.utc():$()};k.toNow=function(i){return this.to(l(this),i)},k.fromNow=function(i){return this.from(l(this),i)}}})})(K);var ot=K.exports;const at=X(ot);L.extend(it),L.extend(at);function Q(n,r){return L.duration(r-n).humanize()}function G(){const n=Array.prototype.slice.call(arguments,0);return function(r){return n.reduce((c,d)=>d(c),r)}}function N(n){return function(r){return n===void 0?r:r[n]}}const ut=["#4285f4","#db4437","#f4b400","#0f9d58","#ab47bc","#5e97f5","#e06055","#f5bf26","#33ab71","#b762c6","#00acc1","#ff855f","#9e9d24","#26b8ca","#ff7043"];function dt(n){const r=window.getComputedStyle(n,null).getPropertyValue("font-size");return parseFloat(r)}function ct(n){return n.r*.299+n.g*.587+n.b*.114}function lt(n){return ct(n)>165}function ht(n){return lt(y.color(n))?"black":"white"}function C(n,r){return"translate("+n+","+r+")"}function ft(){let n=ut,r=5,c=!1,d=!1,$,k,_=0,b=N(0),l=N(1),i=N(2),o=N(3);function O(a){a.each(function(f,p){const D=y.select(this.parentNode),x=D.select("text"),T=D.select("rect"),m=T.attr("width")-2*r,s=l(f);x.text(s);let e=x.node().getComputedTextLength();if(e>m){const t=m<0?0:m/e,u=Math.floor(s.length*t);x.text(u>2?s.slice(0,u-2)+"…":"")}})}function A(a,f){y.active(this).tween("text",function(){return function(p){O(y.select(this))}})}function h(a){const f=a.datum(),p=new Set(y.map(f,b)),D=new V(Y),x=y.scaleOrdinal(n);$=$||[y.min(f,i),y.max(f,o)],d&&($=y.extent($.concat(new Date))),a.each(function(T){const m=k||this.getBoundingClientRect().width,s=p.size*(dt(this)+4*r),e=y.scaleBand().domain(p).range([0,s]),t=y.scaleTime().domain($),u=(c?W:I)(e).width(m),v=y.select(this).selectAll("svg").data([1]).join("svg");v.attr("class","timeline").attr("width",m).attr("height",s+20);const g=v.append("g"),M=g.append("g").attr("class","y axis").call(u);let w=u.range();t.range([w[0]+r,w[1]-r]).clamp(!0);const j=y.axisBottom(t),H=g.append("g").attr("class","x axis").attr("transform",C(0,s)).call(j);M.on("offset",()=>{w=u.range(),t.range([w[0]+r,w[1]-r]).clamp(!0),j.ticks(Math.min((w[1]-w[0])/70,10)),H.call(j),F.attr("transform",P=>C(t(i(P)),e(b(P)))).selectAll("rect").attr("width",P=>t(o(P))-t(i(P))).call(O),M.call(u.draw_ticks,t.ticks().map(t))}),H.select(".domain").remove(),H.selectAll(".tick line").attr("stroke","#AAA");const R=t.ticks().map(t);M.call(u.draw_ticks,R);let F=g.selectAll("g.task").data(T);F.exit().remove();const z=F.enter().append("g").classed("task",!0);z.append("rect").attr("y",r).attr("height",e.bandwidth()-2*r).on("mouseover",D.show).on("mouseout",D.hide).style("fill",G(l,x)),z.append("text").attr("text-anchor","start").attr("fill",G(l,x,ht)).attr("pointer-events","none").attr("dx",r).attr("y",e.bandwidth()/2).attr("dy","0.32em").text(l),F=F.merge(z),F.attr("transform",P=>C(w[0],e(b(P)))).selectAll("rect").attr("width",0),F.transition().duration(_).attr("transform",P=>C(t(i(P)),e(b(P)))).selectAll("rect").attr("width",P=>t(o(P))-t(i(P))).on("start",A),d&&g.append("path").attr("stroke","red").attr("d","M"+t(new Date)+",0.5V"+s)})}return h.dates=function(a){return arguments.length?($=a,h):$},h.width=function(a){return arguments.length?(k=a,h):k},h.today=function(a){return arguments.length?(d=a,h):d},h.colors=function(a){return arguments.length?(n=a,h):n},h.padding=function(a){return arguments.length?(r=a,h):r},h.reversed=function(a){return arguments.length?(c=a,h):c},h.duration=function(a){return arguments.length?(_=a,h):_},h;function Y(a,f){const p=G(y.isoParse,y.timeFormat("%Y-%m-%d"));return"<b>"+l(f)+'</b><hr style="margin: 2px 0 2px 0">'+p(i(f))+" - "+p(o(f))+"<br>"+Q(i(f),o(f))}}S.durationFormat=Q,S.timeline=ft,S.timelineAxisLeft=I,S.timelineAxisRight=W,S.tooltip=V,Object.keys(E).forEach(n=>{n!=="default"&&!Object.prototype.hasOwnProperty.call(S,n)&&Object.defineProperty(S,n,{enumerable:!0,get:()=>E[n]})}),Object.defineProperty(S,Symbol.toStringTag,{value:"Module"})});
